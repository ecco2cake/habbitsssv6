<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>–ü—Ä–∏–≤—ã—á–∫–∏ ¬∑ PWA</title>

  <!-- Cache control meta -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; connect-src 'self';">

  <meta name="theme-color" content="#0e0f12">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('sw.js'));
    }
  </script>
</head>
<body>
  <header class="topbar">
    <div class="left-controls">
      <button id="settingsBtn" class="icon" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
      <div class="month-nav" role="navigation" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º">
        <button id="prevMonth" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü">‚óÄ</button>
        <div id="monthLabel" aria-live="polite"></div>
        <button id="nextMonth" aria-label="–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü">‚ñ∂</button>
      </div>
    </div>
    <div class="toolbar">
      <button id="addHabitBtn" class="round" aria-label="–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É">Ôºã</button>
    </div>
  </header>

  <main id="list" aria-live="polite"></main>

  <template id="habitCardTpl">
    <section class="card" aria-label="–ü—Ä–∏–≤—ã—á–∫–∞">
      <header class="card-head">
        <div class="meta">
          <div class="dot" aria-hidden="true"></div>
          <div class="titles">
            <div class="title"></div>
            <div class="subtitle"></div>
          </div>
        </div>
        <div class="actions">
          <button class="todayBtn" title="–û—Ç–º–µ—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è">‚úÖ</button>
          <button class="edit" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úé</button>
        </div>
      </header>
      <div class="grid" role="grid"></div>
      <footer class="card-foot">
        <div class="stats" aria-live="polite"></div>
      </footer>
    </section>
  </template>

  <dialog id="habitDialog">
    <form method="dialog" class="dialog">
      <h3 id="dlgTitle">–ù–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞</h3>
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ
        <input id="habitName" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –í–æ–¥–∞" required>
      </label>
      <label>–¶–≤–µ—Ç
        <input id="habitColor" type="color" value="#6c5ce7">
      </label>
      <label>–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
        <input id="habitNote" type="text" placeholder="–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">
      </label>
      <div style="display:flex;gap:8px;justify-content:space-between;align-items:center">
        <div>
          <button id="dlgCancel" type="button">–û—Ç–º–µ–Ω–∞</button>
          <button id="dlgSave" type="submit" value="ok" class="primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
        <button id="dlgDelete" type="button" style="display:none;background:#3a2a2a;border-radius:10px;padding:8px 10px">üóë –£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </form>
  </dialog>

  <dialog id="settingsDialog">
    <form method="dialog" class="dialog">
      <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
      <div class="settings-actions">
        <button id="exportBtn" type="button">–≠–∫—Å–ø–æ—Ä—Ç</button>
        <input id="importFile" type="file" accept="application/json" style="display:none">
        <button id="importBtn" type="button">–ò–º–ø–æ—Ä—Ç</button>
        <button id="clearAll" type="button">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
      </div>
      <menu>
        <button value="close">–ó–∞–∫—Ä—ã—Ç—å</button>
      </menu>
    </form>
  </dialog>

  <script src="script.js"></script>
</body>
</html>
